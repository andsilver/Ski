<%= content_for :links_and_search do %>
<script>
$(function() {
  $('#quick-search form').submit(function() {
    if($('#resort_id').val() == '') {
      alert('Please choose a resort first.');
      return false;
    }
  });
});
</script>
<section>
  <h2>Search</h2>
<div id="quick-search">
  <%= form_tag({controller: 'properties', action: 'quick_search'}, method: 'get') do %>
    <select id="resort_id" name="resort_id">
      <option value="">Choose Resort</option>
      <% @country.visible_resorts.each do |resort| %>
      <option value="<%= resort.id %>"><%= resort.name %></option>
      <% end %>
    </select>
    <br>
    <%= render 'properties/sleeps_select' %>
    <br>
    <%= render 'home/arrival_datepicker' %>
    <p style="text-align: right;">
      <input type="submit" value="Search" class="btn btn-large btn-primary">
    </p>
  <% end %>
</div>
</section>

<section>
  <h2>Regions</h2>
  <ul>
<% @country.regions.each do |region| %>
    <li><%= link_to region, region %></li>
<% end %>
  </ul>
</section>

<section>
  <h2>Resorts</h2>
  <ul>
<% @country.visible_resorts.each do |resort| %>
    <li><%= link_to_with_count resort, resort, resort.property_count %></li>
<% end %>
  </ul>
</section>
<% end %>

<div id="content-with-side-banners">
  <% featured_properties = @featured_properties.empty? ? '' : render('shared/featured_properties') %>
  <%= raw Liquid::Template.parse(@country.info).render(
  'featured_properties' => featured_properties,
  'resort_summaries_table' => render('resort_summaries_table')
  ) %>
</div>
<%= render partial: 'directory_adverts/banners', object: [] %>
